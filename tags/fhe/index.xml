<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>FHE on wfz的博客</title>
        <link>https://www.wfz521.com/tags/fhe/</link>
        <description>Recent content in FHE on wfz的博客</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>2025-皮卡丘的守护神</copyright>
        <lastBuildDate>Thu, 16 Oct 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://www.wfz521.com/tags/fhe/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>快速傅里叶变换</title>
        <link>https://www.wfz521.com/p/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/</link>
        <pubDate>Thu, 16 Oct 2025 00:00:00 +0000</pubDate>
        
        <guid>https://www.wfz521.com/p/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/</guid>
        <description>&lt;img src="https://www.wfz521.com/p/%E5%BF%AB%E9%80%9F%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/pkq.png" alt="Featured image of post 快速傅里叶变换" /&gt;&lt;h2 id=&#34;fft&#34;&gt;FFT
&lt;/h2&gt;&lt;h2 id=&#34;fft的误差&#34;&gt;FFT的误差
&lt;/h2&gt;&lt;p&gt;问题1：已知$\mathbf{a}=\mathbf{M}^{-1}\mathbf{b}$，其中$\mathbf{M}\in \mathbb{C}^{n\times n},\mathbf{b}\in \mathbb{C}^{n}$，这里把$\mathbf{a}$看做多项式系数，$\mathbf{b}$看做n维向量，分析$e=\Vert \mathbf{b}-\mathbf{M}\mathbf{a}\Vert_\infty$的上界？&lt;/p&gt;
&lt;p&gt;问题2：已知$\mathbf{a}_1=\mathbf{M}^{-1}\mathbf{b}_1,\mathbf{a}_2=\mathbf{M}^{-1}\mathbf{b}_2$，其中$\mathbf{M}\in \mathbb{C}^{n\times n},\mathbf{b}_1,\mathbf{}_2\in \mathbb{C}^{n}$，分析
$$
e_+=\Vert (\mathbf{b}&lt;em&gt;1+&lt;/em&gt;{simd}\mathbf{b}_2)-\mathbf{M}(\mathbf{a}&lt;em&gt;1+&lt;/em&gt;{poly}\mathbf{a}&lt;em&gt;2)\Vert&lt;/em&gt;\infty\&lt;/p&gt;
&lt;p&gt;e_\times=\Vert (\mathbf{b}&lt;em&gt;1\times&lt;/em&gt;{simd}\mathbf{b}_2)-\mathbf{M}(\mathbf{a}&lt;em&gt;1\times&lt;/em&gt;{poly}\mathbf{a}&lt;em&gt;2)\Vert&lt;/em&gt;\infty
$$
两个误差的上界？&lt;/p&gt;
&lt;p&gt;回答：显然，误差不好准确估计，但是维数越高，误差的上界应该越大。&lt;/p&gt;
&lt;p&gt;对于双精度的FHE运算来说，FFT的运算误差应该可以控制在单精度范围内。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>范数不等式</title>
        <link>https://www.wfz521.com/p/%E8%8C%83%E6%95%B0%E4%B8%8D%E7%AD%89%E5%BC%8F/</link>
        <pubDate>Wed, 15 Oct 2025 00:00:00 +0000</pubDate>
        
        <guid>https://www.wfz521.com/p/%E8%8C%83%E6%95%B0%E4%B8%8D%E7%AD%89%E5%BC%8F/</guid>
        <description>&lt;img src="https://www.wfz521.com/p/%E8%8C%83%E6%95%B0%E4%B8%8D%E7%AD%89%E5%BC%8F/pkq.png" alt="Featured image of post 范数不等式" /&gt;&lt;h2 id=&#34;simd不等式&#34;&gt;SIMD不等式
&lt;/h2&gt;$$
\mathbf{a}=(a_0,a_1,...,a_{n-1}),\mathbf{b}=(b_0,b_1,...,b_{n-1})\\
\mathbf{a}+\mathbf{b} = (a_0+b_0,a_1+b_1,...,a_{n-1}+b_{n-1})\\
\mathbf{a}\circ\mathbf{b} = (a_0\times b_0,a_1\times b_1,...,a_{n-1}\times b_{n-1})\\
\Vert c\circ\mathbf{a}\Vert=c\times\Vert\mathbf{a}\Vert\\
\Vert\mathbf{a}+\mathbf{b}\Vert \leq \Vert\mathbf{a}\Vert+ \Vert\mathbf{b}\Vert\\
\Vert\mathbf{a}\circ\mathbf{b}\Vert \leq \Vert\mathbf{a}\Vert\times \Vert\mathbf{b}\Vert\\
$$&lt;h2 id=&#34;嵌入不等式&#34;&gt;嵌入不等式
&lt;/h2&gt;&lt;p&gt;在n维向量和n个系数的多项式之间存在同构关系$\sigma$，不妨设$a(x)=\Sigma a_iX^i$，满足：
&lt;/p&gt;
$$
\sigma(a(x)+_{\sigma}b(x))=\sigma(a(x))+\sigma(b(x))\\
\sigma(a(x)\cdot_{\sigma}b(x))=\sigma(a(x))\circ\sigma(b(x))
$$&lt;p&gt;
则
&lt;/p&gt;
$$
\Vert\sigma(c\cdot a(x))\Vert = \Vert c\circ \sigma(a(x))\Vert =c\times \Vert\sigma(a(x))\Vert\\
\Vert\sigma(a(x)+_{\sigma}b(x))\Vert \leq \Vert\sigma(a(x))\Vert + \Vert\sigma(b(x))\Vert\\
\Vert\sigma(a(x)\cdot_{\sigma}b(x))\Vert \leq \Vert\sigma(a(x))\Vert \times \Vert\sigma(b(x))\Vert\\
$$&lt;p&gt;
利用这个嵌入不等式就可以很好的分析同态噪声的变化情况，因为密文就是以多项式形式存在，而明文是向量。&lt;/p&gt;
&lt;h2 id=&#34;赫尔德holder不等式&#34;&gt;赫尔德(Holder)不等式
&lt;/h2&gt;&lt;p&gt;已知$\frac{1}{p}+\frac{1}{q}=1,1\leq p\leq+\infty,1\leq q\leq+\infty $，对于任意两个复数向量$\mathbf{a},\mathbf{b}\in \mathbb{C}^n$，有
&lt;/p&gt;
$$
\left|\sum_{i=0}^{n-1}a_i\bar{b}_i\right|\leq \sum_{i=0}^{n-1} \left|a_i\right|\left|b_i\right|\leq\Vert\mathbf{a}\Vert_p\Vert\mathbf{b}\Vert_q
$$&lt;p&gt;
特别的，当p=1时有，$\left|\sum_{i=0}^{n-1}a_i\bar{b}_i\right|\leq \sum_{i=0}^{n-1} \left|a_i\right|\left|b_i\right|\leq\Vert\mathbf{a}\Vert_1\Vert\mathbf{b}\Vert_{\infty}$&lt;/p&gt;
&lt;h2 id=&#34;矩阵-向量不等式&#34;&gt;矩阵-向量不等式
&lt;/h2&gt;&lt;p&gt;对于任意矩阵$\mathbf{M}\in \mathbb{C}^{n\times n}$，任意向量$\mathbf{a}\in\mathbb{R}^n$，令$\mathbf{b}=\mathbf{M}\mathbf{a}$，则
&lt;/p&gt;
$$
b_i=\mathbf{M}_i\mathbf{a}=\sum_{j=0}^{n-1}M_{i,j}a_j\\
a_j\in \mathbb{R},\bar{a}_j = a_j\\
\left|b_i\right| = \left|\sum_{j=0}^{n-1}M_{i,j}a_j\right|=\left|\sum_{j=0}^{n-1}M_{i,j}\bar{a}_j\right|\leq
\Vert\mathbf{M}_i\Vert_p\Vert\mathbf{a}\Vert_q\\
\Vert \mathbf{b}\Vert_\infty\leq \text{max}_{0\leq i\leq n-1}\{{\Vert\mathbf{M}_i\Vert_p}\}\Vert\mathbf{a}\Vert_q
$$&lt;p&gt;
不妨设$\mathbf{M}$可逆，则$\mathbf{a}=\mathbf{M}^{-1}\mathbf{b}$，&lt;/p&gt;
$$\Vert \mathbf{a}\Vert_\infty\leq \text{max}_{0\leq i\leq n-1}\{{\Vert\mathbf{M}^{-1}_i\Vert_p}\}\Vert\mathbf{b}\Vert_q$$&lt;p&gt;综合可得，
&lt;/p&gt;
$$
\frac{\Vert \mathbf{a}\Vert_\infty}{\text{max}_{0\leq i\leq n-1}\{{\Vert\mathbf{M}^{-1}_i\Vert_1}\}}\leq\Vert \mathbf{b}\Vert_\infty\leq \text{max}_{0\leq i\leq n-1}\{{\Vert\mathbf{M}_i\Vert_p}\}\Vert\mathbf{a}\Vert_q
$$&lt;h2 id=&#34;快速傅里叶变换不等式&#34;&gt;快速傅里叶变换不等式
&lt;/h2&gt;&lt;p&gt;FFT里面的矩阵满足&lt;/p&gt;
&lt;p&gt;$\text{max}_{0\leq i\leq n-1}\{{\Vert\mathbf{M}_i\Vert_\infty}\}=1$&lt;/p&gt;
&lt;p&gt;$\text{max}_{0\leq i\leq n-1}\{{\Vert\mathbf{M}_i\Vert_1}\}=n$&lt;/p&gt;
&lt;p&gt;所以有
&lt;/p&gt;
$$
\frac{\Vert \mathbf{a}\Vert_\infty}{\text{max}_{0\leq i\leq n-1}\{{\Vert\mathbf{M}^{-1}_i\Vert_1}\}}\leq\Vert \mathbf{b}\Vert_\infty\leq\Vert\mathbf{a}\Vert_1\leq n\Vert\mathbf{a}\Vert_{\infty}
$$&lt;p&gt;
事实上，$\text{max}_{0\leq i\leq n-1}\{{\Vert\mathbf{M}^{-1}_i\Vert_1}\}=1$，所以
&lt;/p&gt;
$$
\Vert \mathbf{a}\Vert_\infty\leq\Vert \mathbf{b}\Vert_\infty \leq n\Vert\mathbf{a}\Vert_\infty
$$&lt;p&gt;
这样就使用$\mathbf{a}$来约束$\mathbf{b}$的无穷范数上下界了。&lt;/p&gt;
&lt;h2 id=&#34;快速傅里叶嵌入不等式&#34;&gt;快速傅里叶嵌入不等式
&lt;/h2&gt;&lt;p&gt;如果用快速傅里叶变换作为嵌入同构关系，则
&lt;/p&gt;
$$
\Vert a(x)\Vert_\infty \leq \Vert\sigma(a(x))\Vert_\infty \leq \Vert a(x)\Vert_1\leq n\Vert a(x)\Vert_\infty
$$&lt;p&gt;进一步，有
&lt;/p&gt;
$$
\Vert a(x)\cdot_\sigma b(x)\Vert_\infty \leq \Vert \sigma(a(x)\cdot_\sigma b(x))\Vert_\infty \leq \Vert\sigma(a(x))\Vert_\infty \times \Vert\sigma(b(x))\Vert_\infty \leq \Vert a(x)\Vert_1 \times \Vert b(x)\Vert_1 \leq n^2\Vert a(x)\Vert_\infty \Vert b(x)\Vert_\infty
$$&lt;p&gt;
注意$\Vert a(x)\cdot_\sigma b(x)\Vert_\infty \leq n^2\Vert a(x)\Vert_\infty \Vert b(x)\Vert_\infty$这个界不是紧的，应该是
&lt;/p&gt;
$$
\Vert a(x)\cdot_\sigma b(x)\Vert_\infty \leq \Vert a(x)\Vert_2 \Vert b(x)\Vert_2\leq n \Vert a(x)\Vert_\infty \Vert b(x)\Vert_\infty
$$&lt;p&gt;
为什么会出现不紧的界？这是因为虽然不等号具有传递性，但是取得等号的条件不具备传递性，即不同时取得等号。&lt;/p&gt;
&lt;p&gt;实际应用中我们建议使用下面的不等式
&lt;/p&gt;
$$
\Vert \sigma(a(x)\cdot_\sigma b(x))\Vert_\infty \leq n^2\Vert a(x)\Vert_\infty \Vert b(x)\Vert_\infty\\
\Vert \sigma(a(x)+ b(x))\Vert_\infty \leq n(\Vert a(x)\Vert_\infty +\Vert b(x)\Vert_\infty)
$$</description>
        </item>
        
    </channel>
</rss>
