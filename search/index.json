[{"content":"全同态加密+对称密码+隐私计算学习记录\r全同态加密\r全同态加密目前都指的是环同态\n给定两个环结构A和B，各自定义了两种运算$(+_A,\\times_A)$和$(+_B,\\times_B)$，\n如果存在一个映射f: A-\u0026gt;B，满足\n$f(a_0 +_A a_1)=f(a_0) +_B f(a_1)$\n$f(a_0 \\times_A a_1)=f(a_0) \\times_B f(a_1)$\n​\t则称f是A到B的同态映射。\n​\t对于密码方案来说，可以理解为\n$a_0 +_A a_1=Dec(Enc(a_0) +_B Enc(a_1))$\n如何构造全同态？\n有两个难点，一是如何找到两种环结构，二是如何如何针对两种环结构设计出同态映射。\n2009年，MIT的博士生Gentry基于格构造出了首个全同态方案，这个方案的实际性能很差，但是它其中的思想却一直贯彻未来的全同态方案设计当中。直接点说，Gentry基于格的方案是含有噪声的，因此必须要保证最终解密时噪声控制在某个界内，因为同态本质是针对运算做出限制，所以只需要保证每次运算后都能控制噪声在界内即可。Gentry提出了一种叫做“自举”的方法，对运算后的密文进行“同态地解密”，事实上，我觉得这个同态解密的说法不合适。下面想讲一下我个人的理解：\n理解“自举”\n一般来说，全同态加密会有一对密钥：pk、sk，也就是公钥和私钥。\n$c=Enc_{pk}(m),m=Dec_{sk}(c)$\n现在如果再构造一对密钥：$\\overline{bsk},\\overline{pk}$，满足$\\overline{bsk}=\\overline{Enc}_{\\overline{pk}}(sk)$\n自举最关键的步骤是需要把$c=Enc_{pk}(m),m=Dec_{sk}(c)$变为$\\overline{c}=\\overline{Enc}_{\\overline{pk}}(m)$，这一步也被称作重加密，这个称呼是比较贴切的，相当于换个公钥重新加密，解密后的密文可以通过参数的调整保证噪声以“极大概率”落在界内。之后还需要进行一步密钥切换，就是从$\\overline{c}=Enc_{\\overline{pk}}(m)$变成$\\hat{c}=Enc_{pk}(m)$，此时也可以通过调整参数使得噪声以“极大概率”落在界内。这里需要注意一点，自举都是概率性的，无法保证100%成功。\n$\\overline{Enc}_{\\overline{pk}}(m)=\\overline{Enc}_{\\overline{pk}}(Dec_{sk}(c))=Dec_{\\overline{bsk}}(\\overline{Enc}_{\\overline{pk}}(c))$\n通过这个公式，可以看出同态解密这个说法有点不合适，准确的理解应该是先对自举前的密文进行加密再同态地解密。 $$\rc=Enc_{pk}(m),m=Dec_{sk}(c)\\\\\r\\overline{bsk}=\\overline{Enc}_{\\overline{pk}}(sk)\\\\\r\\overline{Enc}_{\\overline{pk}}(m)=\\overline{Enc}_{\\overline{pk}}(Dec_{sk}(c))=Dec_{\\overline{bsk}}(\\overline{Enc}_{\\overline{pk}}(c))\r$$ 当然，也有对称形式的： $$\rc=Enc_{sk}(m),m=Dec_{sk}(c)\\\\\r\\overline{bsk}=Enc_{\\overline{sk}}(sk)\\\\\rEnc_{\\overline{sk}}(m)=Enc_{\\overline{sk}}(Dec_{sk}(c))=Dec_{\\overline{bsk}}(Enc_{\\overline{sk}}(c))\r$$ 注意到，在RLWE中似乎都使用非对称形式的全同态加密，在LWE中更倾向于使用对称形式的，这里应该有一些原因，需要我仔细分析一下。\n自举难点\n$Dec_{\\overline{bsk}}(\\overline{Enc}_{\\overline{pk}}(c))$，这里很显然有一个问题：$c$本身就是密文，如果对密文进行加密呢？这需要对$\\overline{Enc}$进行特别设计，既要和原来的$Enc$能够转换又要满足可以对密文进行同态加密。这是一个非常值得讨论的问题，可以通过这个切入点来看BGV/BFV/CKKS/TFHE等全同态方案的自举是如何设计的？\n自举的设计\n全同态编码\rseal库里面直接系数编码\n1 2 Plaintext pt_bfv; pt_bfv = Plaintext(gsl::span\u0026lt;const uint64_t\u0026gt;(coeffs)); 批处理编码CRT\n混合同态加密\r比较不同同态算法下一些国产对称密码的使用效果 比较不同同态算法下一些统计或机器学习的算法实现效果 RtF框架\r","date":"2025-08-27T00:00:00Z","image":"https://www.wfz521.com/p/fhe/pkq_hu_4cdd2b70889c13db.png","permalink":"https://www.wfz521.com/p/fhe/","title":"FHE"},{"content":"模数切换\rScale定义：\nScale实现：\n$$\rx'=x+\\lceil\\frac{(p-q)x}{qr}\\rfloor r\r$$ 如果四舍五入时，如果刚好小数位等于0.5，则有两种选择即$x+kr$和$x+(k+1)r$，这时通常选择使得最后$[*]_p$之后绝对值较小的那一个。当然也可以随机选择一个，对于噪声上界估计无影响。\n分析 $$\r\\begin{aligned}\r\\left|\\lceil\\frac{(p-q)x}{qr}\\rfloor-\\frac{(p-q)x}{qr}\\right|\\leq 1/2\\\\\r\\left|\\lceil\\frac{(p-q)x}{qr}\\rfloor r-\\frac{(p-q)x}{q}\\right|\\leq r/2\\\\\r\\left|x'-x-\\frac{(p-q)x}{q}\\right|\\leq r/2\\\\\r\\left|x'-\\frac{px}{q}\\right|\\leq r/2\r\\end{aligned}\r$$显然，等号当且仅当$\\frac{(p-q)x}{qr}$的小数位$=0.5$时成立。\n当然实际使用时，这里$\\left|x'-\\frac{px}{q}\\right|$是可以计算出来的，直接用计算出来的数参与上界估计即可。但是理论分析上界直接使用$r/2$就行了。\nBGV密文模数切换\n设BGV明文模数为$P$，密文初始模数为$Q=Q_L$对于级别$L$，类似级别$t(0\\leq t\\leq L)$对应$Q_t$，$Q_t=\\prod_{i=0}^{t} p_i$\n给定一个模数$Q_t$上的BGV密文$c=(c_0,c_1)$，需要将其切换到$Q_{t'}$上的密文$c'=(c_0',c_1')$，其中$t'\\lt t$。\n注意：$c_i\\in Z_{Q_t}[x]/X^N+1$\n操作如下：\n$$\r\\begin{aligned}\rc' \u0026= \\text{Scale}(c) \\\\\rc_0' \u0026= \\text{Scale}(c_0) \\\\\rc_1' \u0026= \\text{Scale}(c_1) \\\\\r\\left|c_0'[j] - Q_{t'}c_0[j]/Q_t\\right| \u0026\\lt P/2, \\quad (j=0,1,\\dots,N-1)\r\\end{aligned}\r$$分析：设私钥为$s$，则BGV解密操作为$m=[[c_0+c_1\\cdot s]_{Q_t}]_P$，即$c_0+c_1\\cdot s\\equiv m+Pv\\;(mod\\;Q_t)$，当 $|m[j]+Pv[j]|\\lt Q/2$ 时才能保证解密唯一正确性。\n模数切换成立的充要条件是解密后对应的明文相同，因此可以对应三个充分条件：\n(1) $c_0[j]+(c_1\\cdot s)[j] \\equiv c_0'[j]+(c_1'\\cdot s)[j]\\;(\\text{mod}\\;P)$ (2) $\\left|c_0[j]+(c_1\\cdot s)[j](\\text{mod}\\; Q_t)\\right|\\lt Q_t/2,\\;\\left|c_0'[j]+(c_1'\\cdot s)[j](\\text{mod}\\; Q_t')\\right|\\lt Q_{t'}/2$ (3) $Q_t\\equiv Q_{t'}\\equiv 1(\\text{mod}\\; P)$ 证明： $$\r\\begin{aligned}\rc_0[j]+(c_1\\cdot s)[j]\u0026=M+k[j]Q_t\\\\\rc_0'[j]+(c_1'\\cdot s)[j]\u0026=M+k[j]Q_t+rP\\\\\rc_0'[j]+(c_1'\\cdot s)[j]\u0026=M'+k'Q_{t'}\\\\\rM+k[j]Q_t+rP\u0026=M'+k'Q_{t'}\\\\\rM+k[j]Q_t+rP\u0026=M'+k'Q_{t'}(\\text{mod}\\;P)\\\\\rM+k[j]\u0026\\equiv M'+k'(\\text{mod}\\;P)\\\\\rM\u0026\\equiv M'(\\text{mod}\\;P)\r\\end{aligned}\r$$ 证毕。\n在条件 (1) 和条件 (3) 满足的前提下，我们只需要验证条件 (2) 即可。\n不妨设 $c_0[j]+(c_1\\cdot s)[j]=m[j]+Pv[j]+k[j]Q_t$，即 $m[j]+Pv[j]=c_0[j]+(c_1\\cdot s)[j](\\text{mod}\\; Q_t)$\n令 $e'[j]=c_0'[j]+(c_1'\\cdot s)[j]-k[j]Q_{t'}$， $$\r\\begin{aligned}\re'[j]\u0026=c_0'[j]-Q_{t'}c_0[j]/Q_t+Q_{t'}c_0[j]/Q_t+(c_1'\\cdot s)[j]+(Q_{t'}c_1/Q_t\\cdot s)[j]-(Q_{t'}c_1/Q_t\\cdot s)[j]-k[j]Q_{t'}\\\\\r\u0026=(-k[j]Q_{t'}+Q_{t'}c_0[j]/Q_t+(Q_{t'}c_1/Q_t\\cdot s)[j])\\\\\r\u0026+c_0'[j]-Q_{t'}c_0[j]/Q_t\\\\\r\u0026+(c_1'\\cdot s)[j]-(Q_{t'}c_1/Q_t\\cdot s)[j]\\\\\r\u0026=Q_{t'}(m[j]+Pv[j])/Q_t\\\\\r\u0026+c_0'[j]-Q_{t'}c_0[j]/Q_t\\\\\r\u0026+((c_1'-Q_{t'}c_1/Q_t)\\cdot s)[j]\r\\end{aligned}\r$$ 多项式乘法的系数上界可以由柯西-施瓦茨不等式确定，$\\left|(c\\cdot s)[j]\\right|\\leq \\Vert c\\Vert_2\\Vert s\\Vert_2$\n所以$\\left|((c_1'-Q_{t'}c_1/Q_t)\\cdot s)[j]\\right|\\leq \\Vert(c_1'-Q_{t'}c_1/Q_t)\\Vert_2\\Vert s\\Vert_2$\n因为$\\left|c_1'[j]-Q_{t'}c_1[j]/Q_t)\\right|\\leq P/2$，所以$||(c_1'-Q_{t'}c_1/Q_t)||_2\\leq P\\sqrt{N}/2$\n因此 $$\r\\begin{aligned}\r\\left|e'[j]\\right|\u0026\\leq \\frac{Q_{t'}}{Q_t}\\left|m[j]+Pv[j]\\right|\\\\\r\u0026+P/2\\\\\r\u0026+P\\sqrt{N}\\Vert s\\Vert_2/2\r\\end{aligned}\r$$ 显然，如果控制$\\left|m[j]+Pv[j]\\right|$和$\\Vert s\\Vert_2$的上界不太大，是可以做到$\\left|e'[j]\\right|\\lt Q_{t'}/2$的，此时$e'[j]=c_0'[j]+(c_1'\\cdot s)[j](\\text{mod}\\; Q_t')$。注意到，如果$\\left|e'[j]\\right|\\lt Q_{t'}/2$，则必须要求$\\left|m[j]+Pv[j]\\right|=\\left|c_0[j]+(c_1\\cdot s)[j](\\text{mod}\\; Q_t\\right|\\lt Q_t/2$。因此条件 (2) 是可以在一定情况下满足的。\n因此如何设置噪声和私钥的上界是核心问题，太大了会导致支持的级别变少。当然此时安全性也会发生变化。\n还有我这里是逐个元素进行绝对值判断，也可以从向量的角度进行范数分析，比如无穷范数/欧几里得范数/嵌入范数等等。\n","date":"2025-08-27T00:00:00Z","image":"https://www.wfz521.com/p/mod-switch/pkq_hu_4cdd2b70889c13db.png","permalink":"https://www.wfz521.com/p/mod-switch/","title":"Mod Switch"},{"content":"This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.\nHeadings\rThe following HTML \u0026lt;h1\u0026gt;—\u0026lt;h6\u0026gt; elements represent six levels of section headings. \u0026lt;h1\u0026gt; is the highest section level while \u0026lt;h6\u0026gt; is the lowest.\nH1\rH2\rH3\rH4\rH5\rH6\rParagraph\rXerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.\nItatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.\nBlockquotes\rThe blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.\nBlockquote without attribution\rTiam, ad mint andaepu dandae nostion secatur sequo quae. Note that you can use Markdown syntax within a blockquote.\nBlockquote with attribution\rDon\u0026rsquo;t communicate by sharing memory, share memory by communicating.\n— Rob Pike1\nTables\rTables aren\u0026rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.\nName Age Bob 27 Alice 23 Inline Markdown within tables\rItalics Bold Code italics bold code A B C D E F Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, sapien non euismod aliquam, dui ligula tincidunt odio, at accumsan nulla sapien eget ex. Proin eleifend dictum ipsum, non euismod ipsum pulvinar et. Vivamus sollicitudin, quam in pulvinar aliquam, metus elit pretium purus Proin sit amet velit nec enim imperdiet vehicula. Ut bibendum vestibulum quam, eu egestas turpis gravida nec Sed scelerisque nec turpis vel viverra. Vivamus vitae pretium sapien Code Blocks\rCode block with backticks\r1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Code block indented with four spaces\r\u0026lt;!doctype html\u0026gt;\r\u0026lt;html lang=\u0026quot;en\u0026quot;\u0026gt;\r\u0026lt;head\u0026gt;\r\u0026lt;meta charset=\u0026quot;utf-8\u0026quot;\u0026gt;\r\u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt;\r\u0026lt;/head\u0026gt;\r\u0026lt;body\u0026gt;\r\u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt;\r\u0026lt;/body\u0026gt;\r\u0026lt;/html\u0026gt;\rCode block with Hugo\u0026rsquo;s internal highlight shortcode\r1 2 3 4 5 6 7 8 9 10 \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Example HTML5 Document\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;p\u0026gt;Test\u0026lt;/p\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; Diff code block\r1 2 3 4 5 [dependencies.bevy] git = \u0026#34;https://github.com/bevyengine/bevy\u0026#34; rev = \u0026#34;11f52b8c72fc3a568e8bb4a4cd1f3eb025ac2e13\u0026#34; - features = [\u0026#34;dynamic\u0026#34;] + features = [\u0026#34;jpeg\u0026#34;, \u0026#34;dynamic\u0026#34;] List Types\rOrdered List\rFirst item Second item Third item Unordered List\rList item Another item And another item Nested list\rFruit Apple Orange Banana Dairy Milk Cheese Other Elements — abbr, sub, sup, kbd, mark\rGIF is a bitmap image format.\nH2O\nXn + Yn = Zn\nPress CTRL + ALT + Delete to end the session.\nMost salamanders are nocturnal, and hunt for insects, worms, and other small creatures.\nHyperlinked image\rThe above quote is excerpted from Rob Pike\u0026rsquo;s talk during Gopherfest, November 18, 2015.\u0026#160;\u0026#x21a9;\u0026#xfe0e;\n","date":"2019-03-11T00:00:00Z","image":"https://www.wfz521.com/p/markdown-syntax-guide/pawel-czerwinski-8uZPynIu-rQ-unsplash_hu_e95a4276bf860a84.jpg","permalink":"https://www.wfz521.com/p/markdown-syntax-guide/","title":"Markdown Syntax Guide"},{"content":"Lorem est tota propiore conpellat pectoribus de pectora summo.\nRedit teque digerit hominumque toris verebor lumina non cervice subde tollit usus habet Arctonque, furores quas nec ferunt. Quoque montibus nunc caluere tempus inhospita parcite confusaque translucet patri vestro qui optatis lumine cognoscere flos nubis! Fronde ipsamque patulos Dryopen deorum.\nExierant elisi ambit vivere dedere Duce pollice Eris modo Spargitque ferrea quos palude Rursus nulli murmur; hastile inridet ut ab gravi sententia! Nomine potitus silentia flumen, sustinet placuit petis in dilapsa erat sunt. Atria tractus malis.\nComas hunc haec pietate fetum procerum dixit Post torum vates letum Tiresia Flumen querellas Arcanaque montibus omnes Quidem et Vagus elidunt\rThe Van de Graaf Canon\nMane refeci capiebant unda mulcebat\rVicta caducifer, malo vulnere contra dicere aurato, ludit regale, voca! Retorsit colit est profanae esse virescere furit nec; iaculi matertera et visa est, viribus. Divesque creatis, tecta novat collumque vulnus est, parvas. Faces illo pepulere tempus adest. Tendit flamma, ab opes virum sustinet, sidus sequendo urbis.\nIubar proles corpore raptos vero auctor imperium; sed et huic: manus caeli Lelegas tu lux. Verbis obstitit intus oblectamina fixis linguisque ausus sperare Echionides cornuaque tenent clausit possit. Omnia putatur. Praeteritae refert ausus; ferebant e primus lora nutat, vici quae mea ipse. Et iter nil spectatae vulnus haerentia iuste et exercebat, sui et.\nEurytus Hector, materna ipsumque ut Politen, nec, nate, ignari, vernum cohaesit sequitur. Vel mitis temploque vocatus, inque alis, oculos nomen non silvis corpore coniunx ne displicet illa. Crescunt non unus, vidit visa quantum inmiti flumina mortis facto sic: undique a alios vincula sunt iactata abdita! Suspenderat ego fuit tendit: luna, ante urbem Propoetides parte.\n","date":"2019-03-09T00:00:00Z","image":"https://www.wfz521.com/p/placeholder-text/matt-le-SJSpo9hQf7s-unsplash_hu_c1ca39d792aee4ab.jpg","permalink":"https://www.wfz521.com/p/placeholder-text/","title":"Placeholder Text"},{"content":"Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.\nIn this example we will be using KaTeX\nCreate a partial under /layouts/partials/math.html Within this partial reference the Auto-render Extension or host these scripts locally. Include the partial in your templates like so: 1 2 3 {{ if or .Params.math .Site.Params.math }} {{ partial \u0026#34;math.html\u0026#34; . }} {{ end }} To enable KaTeX globally set the parameter math to true in a project\u0026rsquo;s configuration To enable KaTeX on a per page basis include the parameter math: true in content files Note: Use the online reference of Supported TeX Functions\nExamples\rInline math: $\\varphi = \\dfrac{1+\\sqrt5}{2}= 1.6180339887…$\nBlock math: $$\r\\varphi = 1+\\frac{1} {1+\\frac{1} {1+\\frac{1} {1+\\cdots} } } $$","date":"2019-03-08T00:00:00Z","permalink":"https://www.wfz521.com/p/math-typesetting/","title":"Math Typesetting"},{"content":"Emoji can be enabled in a Hugo project in a number of ways.\nThe emojify function can be called directly in templates or Inline Shortcodes.\nTo enable emoji globally, set enableEmoji to true in your site\u0026rsquo;s configuration and then you can type emoji shorthand codes directly in content files; e.g.\n🙈 :see_no_evil: 🙉 :hear_no_evil: 🙊 :speak_no_evil:\nThe Emoji cheat sheet is a useful reference for emoji shorthand codes.\nN.B. The above steps enable Unicode Standard emoji characters and sequences in Hugo, however the rendering of these glyphs depends on the browser and the platform. To style the emoji you can either use a third party emoji font or a font stack; e.g.\n1 2 3 .emoji { font-family: Apple Color Emoji, Segoe UI Emoji, NotoColorEmoji, Segoe UI Symbol, Android Emoji, EmojiSymbols; } ","date":"2019-03-05T00:00:00Z","image":"https://www.wfz521.com/p/emoji-support/the-creative-exchange-d2zvqp3fpro-unsplash_hu_27b8954607cdb515.jpg","permalink":"https://www.wfz521.com/p/emoji-support/","title":"Emoji Support"}]